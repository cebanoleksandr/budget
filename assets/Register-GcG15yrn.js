import{_ as c,j as m,k as u,a as g,b as _,c as l,d as r,n as i,t as o,e as n,f as E,w as p,h as v,i as f,F as w,r as b,o as d}from"./index-3X6NywY1.js";const N={name:"register",data:()=>({email:"",password:"",name:"",agree:!1,emailError:"",passwordError:"",nameError:"",agreeError:""}),computed:{error(){return this.$store.getters.error}},methods:{generateEmailError(e){const s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return e?s.test(e)?"":"Incorrect email":"Email is required"},generatePasswordError(e){return e?e.length<6?"Password must have at least 6 characters":"":"Password is required"},generateNameError(e){return e.trim()?"":"Name is require"},submitHandler(){this.emailError=this.generateEmailError(this.email),this.passwordError=this.generatePasswordError(this.password),this.nameError=this.generateNameError(this.name),this.agreeError=this.agree?"":"You should agree to the rules",!(this.emailError||this.passwordError||this.nameError||this.agreeError)&&m(this.email,this.password,this.name).then(e=>{console.log(e.data),typeof e.data=="string"?this.$store.commit("setError",e.data):(localStorage.setItem("currentUser",JSON.stringify(e.data)),this.$store.commit("setUser",e.data),u(e.data.id,15e3).then(s=>{this.$store.commit("setBill",s.data)}),g(e.data.id).then(s=>{this.$store.commit("setCategories",s.data)}),_(e.data.id).then(s=>{this.$store.commit("setRecords",s.data)}))}).then(()=>{this.$store.getters.error||this.$router.push("/")}).catch(e=>{throw new Error(e)}).finally(()=>{setTimeout(()=>{this.$store.commit("clearError")},3e3)})},changeEmail(e){this.emailError&&(this.emailError=this.generateEmailError(e.target.value)),this.email=e.target.value},changePassword(e){this.passwordError&&(this.passwordError=this.generatePasswordError(e.target.value)),this.password=e.target.value},changeName(e){this.nameError&&(this.nameError=this.generateNameError(e.target.value)),this.name=e.target.value},changeAgree(e){this.agreeError&&(this.agreeError=this.agree?"":"You should agree to the rules"),this.agree=e.target.value}}},P=r("h2",{class:"is-size-2 has-text-centered mb-4"}," Registration ",-1),y={class:"field"},I=r("label",{class:"label"},"Name",-1),k={class:"control"},A=["value"],C={class:"error-container"},B={class:"has-text-danger"},S={class:"field"},x=r("label",{class:"label"},"Email",-1),R={class:"control"},V=["value"],q={class:"error-container"},H={class:"has-text-danger"},U={class:"field"},z=r("label",{class:"label"},"Password",-1),D={class:"control"},F=["value"],T={class:"error-container"},Y={class:"has-text-danger"},$={class:"field"},j={class:"control"},J={class:"checkbox"},L=["value"],M={class:"error-container"},O={class:"has-text-danger"},G=r("div",{class:"mt-6 has-text-centered"},[r("button",{class:"button is-primary is-rounded"},"Sign Un")],-1),K={class:"has-text-centered mt-4"},Q={key:0,class:"notification absolute is-danger"},W=r("button",{class:"delete"},null,-1);function X(e,s,Z,ee,re,t){const h=b("router-link");return d(),l(w,null,[r("form",{class:"login-form",novalidate:"",onSubmit:s[4]||(s[4]=v((...a)=>t.submitHandler&&t.submitHandler(...a),["prevent"]))},[P,r("div",y,[I,r("div",k,[r("input",{type:"text",class:i(["input",{"is-danger":e.nameError}]),value:e.name,onInput:s[0]||(s[0]=(...a)=>t.changeName&&t.changeName(...a)),placeholder:"Name..."},null,42,A)]),r("div",C,[r("small",B,o(e.nameError),1)])]),r("div",S,[x,r("div",R,[r("input",{type:"email",class:i(["input",{"is-danger":e.emailError}]),value:e.email,onInput:s[1]||(s[1]=(...a)=>t.changeEmail&&t.changeEmail(...a)),placeholder:"Email..."},null,42,V)]),r("div",q,[r("small",H,o(e.emailError),1)])]),r("div",U,[z,r("div",D,[r("input",{type:"password",class:i(["input",{"is-danger":e.passwordError}]),value:e.password,onInput:s[2]||(s[2]=(...a)=>t.changePassword&&t.changePassword(...a)),placeholder:"Password..."},null,42,F)]),r("div",T,[r("small",Y,o(e.passwordError),1)])]),r("div",$,[r("div",j,[r("label",J,[r("input",{type:"checkbox",value:e.agree,onInput:s[3]||(s[3]=(...a)=>t.changeAgree&&t.changeAgree(...a))},null,40,L),n(" I agree to the rules ")])]),r("div",M,[r("small",O,o(e.agreeError),1)])]),G,r("p",K,[n(" Do you have an account? "),E(h,{to:"/login"},{default:p(()=>[n("Login")]),_:1})])],32),t.error?(d(),l("div",Q,[W,r("strong",null,o(t.error),1)])):f("",!0)],64)}const te=c(N,[["render",X]]);export{te as default};
