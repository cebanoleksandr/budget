import{_,M as b,N as f,b as E,c as o,e as c,f as A,w as D,h as k,d as e,n as u,F as p,p as C,t as n,O as g,P as v,i as y,r as I,o as a}from"./index-3X6NywY1.js";const R={name:"record",data:()=>({select:"",type:"outcome",amount:"",description:"",selectError:"",amountError:"",descriptionError:""}),computed:{categories(){return this.$store.getters.getCategories},canCreateRecord(){var t;return this.type==="income"?!0:((t=this.$store.getters.bill)==null?void 0:t.bill)>=+this.amount},error(){return this.$store.getters.error},message(){return this.$store.getters.message}},methods:{changeSelect(t){this.select=t.target.value,this.validateSelect()},changeType(t){this.type=t},changeAmount(t){this.amount=t.target.value,this.validateAmount()},changeDescription(t){this.description=t.target.value,this.validateDescription()},validateSelect(){this.select?this.selectError="":this.selectError="You must choose the category"},validateAmount(){const t=/^[1-9][0-9]*$/;this.amount?t.test(this.amount)?this.amountError="":this.amountError="It must be a number":this.amountError="Amount is require"},validateDescription(){this.description?this.descriptionError="":this.descriptionError="Description is require"},reset(){this.select="",this.type="outcome",this.amount="",this.description="",this.selectError="",this.amountError="",this.descriptionError=""},submitHandler(){var t;if(this.validateAmount(),this.validateDescription(),this.validateSelect(),!(this.selectError||this.amountError||this.descriptionError))if(this.canCreateRecord){const s={categoryId:this.select,userId:(t=this.$store.getters.user)==null?void 0:t.id,amount:this.amount,description:this.description,type:this.type,date:new Date};b(s).then(h=>{var d,r;const m=this.type==="income"?+this.amount:0-+this.amount;f((d=this.$store.getters.user)==null?void 0:d.id,m).then(l=>{this.$store.commit("setBill",l.data),this.$store.commit("setMessage","Record is created successfully"),this.reset(),setTimeout(()=>{this.$store.commit("clearMessage")},3e3)}),E((r=this.$store.getters.user)==null?void 0:r.id).then(l=>{this.$store.commit("setRecords",l.data)})}).catch(h=>{})}else this.$store.commit("setError",`Not enough money in the account (-${+this.amount-this.$store.getters.bill.bill})`),setTimeout(()=>{this.$store.commit("clearError")},3e3)}}},w=e("h2",{class:"is-size-2 mb-2"},"New Record",-1),S=e("div",{class:"hr"},null,-1),T={key:0,class:"is-size-3 has-text-centered w100 mt-6"},B={class:"field"},N=e("label",{class:"label"},"Title",-1),V=["value"],$=e("option",{disabled:"",value:""},"Select category title",-1),M=["value"],P={class:"help has-text-danger err-height"},z={class:"control mb-3"},H={class:"field"},q=e("label",{class:"label"},"Amount",-1),F={class:"control"},O=["value"],U={class:"help has-text-danger err-height"},x={class:"field"},L=e("label",{class:"label"},"Description",-1),Y={class:"control"},j=["value"],G={class:"help has-text-danger err-height"},J=e("div",{class:"control"},[e("button",{class:"button is-success"},[c(" Create   "),e("i",{class:"fa fa-paper-plane"})])],-1),K={key:2,class:"notification absolute is-danger"},Q=e("button",{class:"delete"},null,-1),W={key:3,class:"notification absolute is-success"},X=e("button",{class:"delete"},null,-1);function Z(t,s,h,m,d,r){const l=I("router-link");return a(),o(p,null,[w,S,r.categories.length?(a(),o("form",{key:1,class:"mt-2 max-width-500 center",onSubmit:s[9]||(s[9]=k((...i)=>r.submitHandler&&r.submitHandler(...i),["prevent"]))},[e("div",B,[N,e("div",{class:u(["select is-primary",{"is-danger":!!t.selectError}])},[e("select",{value:t.select,onInput:s[0]||(s[0]=(...i)=>r.changeSelect&&r.changeSelect(...i))},[$,(a(!0),o(p,null,C(r.categories,i=>(a(),o("option",{key:i.id,value:i.id},n(i.title),9,M))),128))],40,V)],2),e("p",P,n(t.selectError),1)]),e("div",z,[e("label",{class:"radio",onClick:s[2]||(s[2]=i=>r.changeType("income"))},[g(e("input",{type:"radio",value:"income","onUpdate:modelValue":s[1]||(s[1]=i=>t.type=i)},null,512),[[v,t.type]]),c(" Income ")]),e("label",{class:"radio",onClick:s[4]||(s[4]=i=>r.changeType("outcome"))},[g(e("input",{type:"radio",value:"outcome","onUpdate:modelValue":s[3]||(s[3]=i=>t.type=i)},null,512),[[v,t.type]]),c(" Outcome ")])]),e("div",H,[q,e("div",F,[e("input",{class:u(["input is-primary",{"is-danger":!!t.amountError}]),type:"text",placeholder:"Amount...",value:t.amount,onInput:s[5]||(s[5]=(...i)=>r.changeAmount&&r.changeAmount(...i)),onBlur:s[6]||(s[6]=i=>r.validateAmount())},null,42,O)]),e("p",U,n(t.amountError),1)]),e("div",x,[L,e("div",Y,[e("textarea",{class:u(["textarea is-primary",{"is-danger":!!t.descriptionError}]),type:"text",placeholder:"Description...",value:t.description,onInput:s[7]||(s[7]=(...i)=>r.changeDescription&&r.changeDescription(...i)),onBlur:s[8]||(s[8]=i=>r.validateDescription())},null,42,j)]),e("p",G,n(t.descriptionError),1)]),J],32)):(a(),o("h3",T,[c(" There are no categories.   "),A(l,{to:"/categories"},{default:D(()=>[c("Add category")]),_:1})])),r.error?(a(),o("div",K,[Q,e("strong",null,n(r.error),1)])):y("",!0),r.message?(a(),o("div",W,[X,e("strong",null,n(r.message),1)])):y("",!0)],64)}const te=_(R,[["render",Z]]);export{te as default};
