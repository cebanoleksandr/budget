import{_ as u,l as m,g,a as f,b as p,c as i,d as e,n,t as o,e as d,f as _,w as E,h as w,i as c,F as v,r as b,o as l}from"./index-3X6NywY1.js";const P={name:"login",data:()=>({email:"",password:"",emailError:"",passwordError:"",notificationType:"",notificationText:""}),mounted(){this.$route.query.message==="logout"&&(this.notificationType="is-danger",this.notificationText="You logged out",setTimeout(()=>{this.notificationType="",this.notificationText=""},3e3))},computed:{error(){return this.$store.getters.error}},methods:{generateEmailError(t){const s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t?s.test(t)?"":"Incorrect email":"Email is required"},generatePasswordError(t){return t?t.length<6?"Password must have at least 6 characters":"":"Password is required"},submitHandler(){this.emailError=this.generateEmailError(this.email),this.passwordError=this.generatePasswordError(this.password),!(this.emailError||this.passwordError)&&m(this.email,this.password).then(t=>{typeof t.data=="string"?this.$store.commit("setError",t.data):(localStorage.setItem("currentUser",JSON.stringify(t.data)),this.$store.commit("setUser",t.data),g(t.data.id).then(s=>{this.$store.commit("setBill",s.data)}),f(t.data.id).then(s=>{this.$store.commit("setCategories",s.data)}),p(t.data.id).then(s=>{this.$store.commit("setRecords",s.data)}))}).then(()=>{this.$store.getters.error||this.$router.push("/")}).catch(t=>{console.log(t)}).finally(()=>{setTimeout(()=>{this.$store.commit("clearError")},3e3)})},changeEmail(t){this.emailError&&(this.emailError=this.generateEmailError(t.target.value)),this.email=t.target.value},changePassword(t){this.passwordError&&(this.passwordError=this.generatePasswordError(t.target.value)),this.password=t.target.value}}},y=e("h2",{class:"is-size-2 has-text-centered mb-4"}," Home Budget ",-1),T={class:"field"},I=e("label",{class:"label"},"Email",-1),$={class:"control"},k=["value"],x={class:"error-container"},B={class:"has-text-danger"},C={class:"field"},N=e("label",{class:"label"},"Password",-1),S={class:"control"},A=["value"],H={class:"error-container"},V={class:"has-text-danger"},q=e("div",{class:"mt-6 has-text-centered"},[e("button",{class:"button is-success is-rounded"},"Sign In")],-1),R={class:"has-text-centered mt-4"},z=e("button",{class:"delete"},null,-1),F={key:1,class:"notification absolute is-danger"},U=e("button",{class:"delete"},null,-1);function D(t,s,J,L,M,r){const h=b("router-link");return l(),i(v,null,[e("form",{class:"login-form",novalidate:"",onSubmit:s[2]||(s[2]=w((...a)=>r.submitHandler&&r.submitHandler(...a),["prevent"]))},[y,e("div",T,[I,e("div",$,[e("input",{type:"email",class:n(["input",{"is-danger":t.emailError}]),value:t.email,onInput:s[0]||(s[0]=(...a)=>r.changeEmail&&r.changeEmail(...a)),placeholder:"Email..."},null,42,k)]),e("div",x,[e("small",B,o(t.emailError),1)])]),e("div",C,[N,e("div",S,[e("input",{type:"password",class:n(["input",{"is-danger":t.passwordError}]),value:t.password,onInput:s[1]||(s[1]=(...a)=>r.changePassword&&r.changePassword(...a)),placeholder:"Password..."},null,42,A)]),e("div",H,[e("small",V,o(t.passwordError),1)])]),q,e("p",R,[d(" No account? "),_(h,{to:"/register"},{default:E(()=>[d("Register")]),_:1})])],32),t.notificationText?(l(),i("div",{key:0,class:n(["notification absolute",t.notificationType])},[z,e("strong",null,o(t.notificationText),1)],2)):c("",!0),r.error?(l(),i("div",F,[U,e("strong",null,o(r.error),1)])):c("",!0)],64)}const Y=u(P,[["render",D]]);export{Y as default};
